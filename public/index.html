<!doctype html>
<html>
<head><meta charset="utf-8"><title>VJ Gateway â€” Submit Request</title></head>
<body style="font-family:system-ui,arial;padding:20px;max-width:720px">
<h1>Send a request</h1>
<form id="f">
  <div><input name="name" placeholder="Your name" required style="width:100%"></div><br>
  <div><input name="email" placeholder="Email" required style="width:100%"></div><br>
  <div>
    <select name="purpose" style="width:100%">
      <option>Question</option>
      <option>Appointment</option>
      <option>Chat request</option>
      <option>Other</option>
    </select>
  </div><br>
  <div><input name="referral" placeholder="Referral code (optional)" style="width:100%"></div><br>
  <div><textarea name="message" placeholder="Write your message" required style="width:100%;height:140px"></textarea></div><br>
  <button>Send Request</button>
</form>

<script>
const form = document.getElementById('f');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const o = Object.fromEntries(new FormData(form).entries());
  const res = await fetch('/api/request', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify(o)
  });
  const j = await res.json();
  if (j.ok) {
    alert('Request sent! Your token: ' + j.token + '\nOpening status page now.');
    window.location.href = j.statusUrl;
  } else {
    alert('Error: ' + (j.error || 'unknown'));
    console.error(j);
  }
});
</script>
</body>
</html>
